# High Performance Environment Template
# Optimized for maximum throughput and low latency
# Use when handling high volumes of traffic where performance is critical

# === Core Proxy Settings ===
# Maximum worker count for high throughput
Workers=25
# Large queue for handling burst traffic
MaxQueueLength=50
# Extended timeout for complex requests (30 minutes)
Timeout=1800000
# Fast polling for responsiveness
PollInterval=5000
PollTimeout=1000

# === Priority & Queue Management ===
# Multiple priority levels for fine-grained control
DefaultPriority=2
PriorityKeyHeader=S7PPriorityKey
PriorityKeys=urgent,high,normal,low
PriorityValues=0,1,2,3
# Optimized worker allocation for performance
PriorityWorkers=0:5,1:8,2:10,3:2

# === Backend Configuration ===
# Latency-based load balancing for best performance
LoadBalanceMode=latency
# Required: Set your backend hosts
# Host1=https://your-primary-backend.example.com
# Host2=https://your-secondary-backend.example.com
# Host3=https://your-tertiary-backend.example.com
# Probe_path1=/health
# Probe_path2=/health
# Probe_path3=/health

# === Connection Settings ===
# Aggressive keep-alive for connection reuse
KeepAliveInitialDelaySecs=30
KeepAlivePingIntervalSecs=30
KeepAliveIdleTimeoutSecs=1800
# Enable multiple HTTP/2 connections for maximum throughput
EnableMultipleHttp2Connections=true
MultiConnLifetimeSecs=7200
MultiConnIdleTimeoutSecs=600
MultiConnMaxConns=10000

# === Circuit Breaker (Aggressive) ===
# Fast failure detection and recovery
CBErrorThreshold=30
CBTimeslice=30
SuccessRate=95

# === Async Operations (Enabled for performance) ===
AsyncModeEnabled=true
AsyncTimeout=900000
AsyncTriggerTimeout=5000

# === Storage & Database (Enabled) ===
StorageDbEnabled=true
StorageDbContainerName=Requests

# === Authentication (Minimal overhead) ===
UseOAuth=false
UseOAuthGov=false
ValidateAuthAppID=false
UseProfiles=false

# === Logging (Minimal for performance) ===
# Reduce logging to minimize I/O overhead
LogConsole=false
LogConsoleEvent=false
LogAllRequestHeaders=false
LogAllResponseHeaders=false
LogPoller=false
LogProbes=false
# Only log performance-critical headers
LogHeaders=

# === Header Management ===
# Minimal header processing for speed
RequiredHeaders=
DisallowedHeaders=
StripHeaders=
ValidateHeaders=
TimeoutHeader=S7PTimeout
TTLHeader=S7PTTL

# === Response Settings ===
AcceptableStatusCodes=200,202,401,403,404,408,410,412,417,400
DefaultTTLSecs=600

# === User Management (Optimized) ===
UserIDFieldName=userId
UniqueUserHeaders=X-UserID
UserPriorityThreshold=0.05

# === Container Settings ===
RequestIDPrefix=S7P-PERF
S7P_ThreadPoolMinThreads=32
S7P_ThreadPoolMaxThreads=0
S7P_UseHighPerformanceTimers=true